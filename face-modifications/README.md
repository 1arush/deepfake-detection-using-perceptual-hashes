# detection in facial feature modifications

- `feature_preprocess.ipynb` : This notebook contains all the code used to perform automatic feature detection. It crops the images after obtaining bounding boxes for each feature and saves them. It also contains the code which performs automatic feature modifications to the lips and nose.
-  `face_modifications.py` : This python code creates a single csv file for each face image. Each csv contains columns representing the different modifications and in each column, the values of hamming distances for that modification. The first row is the distance between the face image and its fake. The subsequent images are distances computed for chunk levels on the cropped images.
-  `face_modifications.scala` : This has a similar functionality to the python file, however it produces transposed csv files (rows are swapped with columns). This issue is resolved in `face_plots.ipynb`.
-  `face_plots.ipynb` : This notebook contains all the code used to create plots using the generated csv files. Furhthermore, it contains a code snippet to transpose the csv files generated by the scala code.

<p align="center">
  <img src="https://github.com/user-attachments/assets/c4e946ac-c55a-4a44-af8c-2ca4f2b0a059" alt="sample" width=600>
</p>


## Images

The `images` are organized into a directory structure, which is illustrated with an example below:

```
f1/
    └── lips/
        ├── base.jpg
        └── lipbox.jpg
```

 - `f1` represents the image under consideration, in this case female 1.

 - `lips` represents what modification we are investigating. `lips_code` signifies that the modifications have been made automatically. `base` includes the real, unmodified image.

 - Inside the `lips` folder, there are images such as `base.jpg` and `lipbox.jpg`. `base.jpg` is the full facial image that contains lip modifications, and `lipbox.jpg` is a crop of the lip region made using dlib shape predictor. Each folder contains all the associated images.

## CSV

There are 8 csv files, 4 from the python code and 4 from the scala code. The 4 csv files represent 4 different images, which is also a part of the filename itself.
Here is an example:

`py_f1_face.csv` : made with python code, for face image `f1` 

## Plots

There are 4 sub-directories for the 4 images that have been considered. They contain all the plots for modifications done on that face. The modifications follow a similar naming convention as mentioned above in the `Images` section.

Additionally, there are some plots which are average hamming distance plots. They have been created by averaging out the values from all 4 images, and show an improvement in the detection, as improvisations to the detection procedure are made. There is one such plot for each modification made (these include both manual and automatic modifications). The automatic modifications usually contain a `_code` at the end of their name.






